{% load staticfiles %}
{% load RecordFilter %}
<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>SR Tracker</title>
    <link type="text/css" rel="stylesheet" href="{% static "recordlist/css/bootstrap.min.css" %}"/>
    <link type="text/css" rel="stylesheet" href="{% static "recordlist/css/bootstrap-theme.min.css" %}">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script type="javascript" src="{% static "recordlist/js/bootstrap.js" %}"></script>
</head>
<script lang="javascript">
    $(document).on('ready', function () {
        $('#select-all').on('change', function() {
            var checked = $(this).is(':checked');

            $('[name="recordid"]').each(function() {
               $(this).prop('checked', checked);
            });
        });

        $('#btn-review').click(function() {
            $('#form').attr('action', '{% url 'markreview' %}');
            $('#form').submit();
        });
    });
</script>
<body style="padding: 10px">
    <div class="page-header">
      <h1>SR Tracker <small>List View</small></h1>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <a class="btn btn-primary" id="btn-create" href="{% url 'create' %}">
          <span class="glyphicon glyphicon-plus"></span> Add
        </a>

        <button type="submit" class="btn btn-success" id="btn-review">
            <span class="glyphicon glyphicon-check"></span> Mark Reviewed
        </button>


        <div class="btn-group align-right">
            <button type="button" class="btn btn-default">
                <span class="glyphicon glyphicon-filter"></span>Filter
            </button>
        </div>
      </div>
    </div>

    <nav>
        <ul class="pagination">
        <li>
            {% if records.has_previous %}
            <a href="{{ current_url|dump_page_url:records.previous_page_number }}" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
            {% endif %}
        </li>
        <li><a href="#" aria-label="Current">Page {{ records.number }} of {{ records.paginator.num_pages }}</a></li>
        <li>
            {% if records.has_next %}
              <a href="{{ current_url|dump_page_url:records.next_page_number }}" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
              </a>
            {% endif %}
        </li>
      </ul>
        <h4>Total Row Count: <span class="label label-default">{{ total_count }}</span></h4>
    </nav>

    <form method="post" id="form">
    {% csrf_token %}

    <table class="table table-bordered table-hover">
        <tr>
            <th><input type="checkbox" id="select-all"></th>
            {% for header in header_all %}
            <th>
                <a href="{{ current_url|dump_order_url:header.name }}" class="btn {{ header.caret_style }}">
                    {{ header }}
                    {% if header.show_caret %}
                        <span class="caret"></span>
                    {% endif %}
                </a>
            </th>
            {% endfor %}
        </tr>

        {% for record in records %}
        <tr style="cursor: pointer">
            <td><input type="checkbox" name="recordid" value="{{ record.recordId }}"></td>
            <td> <a href="{% url 'detail' record.recordId %}">{{ record.recordId }}</a> </td>
            {% for header in header_no_id %}
                <td>{{ record|field:header }}</td>
            {% endfor %}
        </tr>
        {% endfor %}
    </table>
    </form>

    <nav>
        <ul class="pagination">
        <li>
            {% if records.has_previous %}
            <a href="{{ current_url }}page={{ records.previous_page_number }}" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
            {% endif %}
        </li>
        <li><a href="#" aria-label="Current">Page {{ records.number }} of {{ records.paginator.num_pages }}</a></li>
        <li>
            {% if records.has_next %}
              <a href="{{ current_url }}page={{ records.next_page_number }}" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
              </a>
            {% endif %}
        </li>
      </ul>
    </nav>
</body>
</html>